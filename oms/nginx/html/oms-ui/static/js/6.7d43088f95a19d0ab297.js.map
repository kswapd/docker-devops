{"version":3,"sources":["webpack:///./src/assets/images/sync-succ.png","webpack:///src/components/config/syn-config.vue","webpack:///./src/components/config/syn-config.vue?a6e1","webpack:///./src/components/config/syn-config.vue"],"names":["module","exports","__webpack_require__","p","syn_config","data","step","myTime","hasDiff","namespaceName","title","text","navSelects","configSelects","computed","extends_default","Object","vuex_esm","navTree","state","_navTree","synConfig","forEach","value","clusters","key","env","clusterName","name","push","configList","diffData","activated","vm","this","params","$route","query","getConfigData","getEnvData","methods","checked","list","res","i","$refs","toggleRowSelection","getConfigList","getNavTree","handleNext","validateCheck","synParam","syncItems","syncToNamespaces","getSynData","length","$message","warning","handleNavChange","val","handleConfigChange","handleSyn","dealSynData","setSynData","synParamList","_diffData","commonFunc","arrCopy","_navSelects","map","obj","item","namespace","appId","diffs","goBack","$router","id","handleDelete","index","splice","updateItems","url","$axios","method","then","oldItemMap","oldValue","type","catch","err","console","log","config_syn_config","render","_vm","_h","$createElement","_c","_self","staticClass","_v","_s","attrs","size","on","click","_e","directives","rawName","expression","_m","span","ref","staticStyle","width","stripe","tooltip-effect","max-height","selection-change","prop","label","offset","scopedSlots","_u","fn","scope","_f","row","dataChangeCreatedTime","dataChangeLastModifiedTime","_l","align","$event","$index","color","text-align","padding","height","src","font-size","font-weight","margin-top","staticRenderFns","padding-left","list-style-type","Component","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/6.7d43088f95a19d0ab297.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/img/sync-succ.72f1963.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/images/sync-succ.png\n// module id = DSqI\n// module chunks = 6","<template>\n  <div class=\"syn-config\">\n    <div class=\"syn-header clearfix\">\n      <div class=\"hd-title\">\n        同步配置\n        <span class=\"sub-title\">{{title}}</span>\n      </div>\n      <div class=\"hd-handle\">\n        <el-button v-if=\"step!=3\" type=\"primary\" size=\"small\" @click=\"handleNext\">{{text}}</el-button>\n        <el-button v-if=\"step===2&&hasDiff\" type=\"success\" size=\"small\" @click=\"handleSyn\">同步</el-button>\n        <el-button type=\"primary\" size=\"small\" @click=\"goBack\">返回项目首页</el-button>\n      </div>\n    </div>\n    <div v-show=\"step===1\" class=\"syn-center\">\n      <div class=\"syn-tips\">\n        <div class=\"tips-title\">Tips：</div>\n        <ul style=\"padding-left: 40px;list-style-type: disc;\">\n          <li class=\"tips-item\">通过同步配置功能，可以使多个环境、集群间的配置保持一致</li>\n          <li class=\"tips-item\">需要注意的是，同步完之后需要发布后才会对应用生效</li>\n        </ul>\n      </div>\n      <div class=\"syn-des\">\n        <!-- <el-row class=\"mb-10\">\n          <el-col :span=\"3\">同步到NameSpace</el-col>\n          <el-col :span=\"7\">{{namespaceName}}</el-col>\n          <el-col :span=\"3\" :offset=\"1\">需要同步的配置</el-col>\n          <el-col :span=\"5\">\n            <el-date-picker\n              v-model=\"myTime\"\n              type=\"daterange\"\n              size=\"small\"\n              align=\"center\"\n              start-placeholder=\"开始日期\"\n              end-placeholder=\"结束日期\"\n              :default-time=\"['12:00:00', '12:00:00']\">\n            </el-date-picker>\n          </el-col>\n          <el-col :span=\"4\" :offset=\"1\">\n            <el-button type=\"primary\" size=\"small\">查询</el-button>\n            <el-button type=\"primary\" size=\"small\">重置</el-button>\n          </el-col>\n        </el-row> -->\n        <el-row>\n          <el-col :span=\"3\">同步到哪个集群</el-col>\n          <el-col :span=\"7\">\n            <el-table\n              ref=\"navTree\"\n              stripe\n              :data=\"navTree\"\n              tooltip-effect=\"dark\"\n              style=\"width: 100%\"\n              max-height=\"250\"\n              key=\"nav-table\"\n              @selection-change=\"handleNavChange\">\n              <el-table-column\n                type=\"selection\"\n                width=\"55\">\n              </el-table-column>\n              <el-table-column\n                prop=\"env\"\n                label=\"环境\">\n              </el-table-column>\n              <el-table-column\n                prop=\"name\"\n                label=\"集群\">\n              </el-table-column>\n            </el-table>\n          </el-col>\n          <el-col :span=\"13\" :offset=\"1\">\n            <el-table\n              stripe\n              ref=\"configList\"\n              :data=\"configList\"\n              tooltip-effect=\"dark\"\n              style=\"width: 100%\"\n              max-height=\"250\"\n              key=\"config-table\"\n              @selection-change=\"handleConfigChange\">\n              <el-table-column\n                type=\"selection\"\n                width=\"55\">\n              </el-table-column>\n              <el-table-column\n                label=\"Key\"\n                prop=\"key\">\n              </el-table-column>\n              <el-table-column\n                prop=\"value\"\n                label=\"Value\">\n              </el-table-column>\n              <el-table-column\n                label=\"Create Time\">\n                <template slot-scope=\"scope\">\n                  {{scope.row.dataChangeCreatedTime | formatDateTime}}\n                </template>\n              </el-table-column>\n              <el-table-column\n                label=\"Update Time\">\n                <template slot-scope=\"scope\">\n                  {{scope.row.dataChangeLastModifiedTime | formatDateTime}}\n                </template>\n              </el-table-column>\n            </el-table>\n          </el-col>\n        </el-row>\n      </div>\n    </div>\n    <div v-show=\"step===2\" class=\"syn-info\">\n      <div class=\"info-space\" v-for=\"(list,index) of diffData\" :key=\"index\">\n        <div class=\"info-hd\">\n          环境：{{list.namespace.env}} 集群：{{list.namespace.clusterName}} NameSpace：{{list.namespace.namespaceName}}\n        </div>\n        <div class=\"info-tb\">\n          <el-table\n            v-if=\"list.diffs.length>0\"\n            :data=\"list.diffs\"\n            key=\"list.namespace.clusterName\"\n            stripe\n            size=\"small\"\n            style=\"width: 100%\">\n            <el-table-column\n              prop=\"type\"\n              label=\"Type\"\n              width=\"100\"\n              align=\"center\">\n            </el-table-column>\n            <el-table-column\n              prop=\"key\"\n              label=\"key\"\n              align=\"center\">\n            </el-table-column>\n            <el-table-column\n              prop=\"oldValue\"\n              label=\"同步前\"\n              align=\"center\">\n            </el-table-column>\n            <el-table-column\n              prop=\"value\"\n              label=\"同步后\"\n              align=\"center\">\n            </el-table-column>\n            <el-table-column\n              prop=\"comment\"\n              label=\"Comment\">\n            </el-table-column>\n            <el-table-column label=\"操作\" width=\"100\" align=\"center\">\n              <template slot-scope=\"scope\">\n                <el-button\n                  size=\"small\"\n                  type=\"text\"\n                  class=\"btn-text-red\"\n                  @click=\"handleDelete(list.diffs,scope.$index)\">删除\n                </el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n          <div v-else style=\"color: #ccc\">没有更新的配置, 忽略同步</div>\n        </div>\n      </div>\n    </div>\n    <div v-show=\"step===3\" style=\"text-align: center;padding: 20px;\">\n      <img style=\"height: 100px;width: 100px;\" src=\"../../assets/images/sync-succ.png\">\n      <div style=\"font-size: 18px;font-weight: bolder;margin-top: 10px\">同步成功！</div>\n    </div>\n  </div>\n</template>\n\n<script>\n  import {mapState, mapActions} from 'vuex'\n\n  export default {\n    data() {\n      return {\n        step: 1,\n        myTime: '',\n        hasDiff: false,\n        namespaceName: '',\n        title: '(第一步选择同步信息)',\n        text: '下一步',\n        navSelects: [],\n        configSelects: []\n      }\n    },\n    computed: {\n      ...mapState({\n        navTree: state => {\n          let _navTree = []\n          const res = state.synConfig.navTree\n          res.forEach(function (value) {\n            value.clusters.forEach(function (key) {\n              key.env = value.env\n              key.clusterName = key.name\n              key.namespaceName = key.namespaceName\n              _navTree.push(key)\n            })\n          })\n          return _navTree\n        },\n        configList: state => state.synConfig.configList,\n        diffData: state => state.synConfig.diffData\n      })\n    },\n    activated() {\n      const vm = this\n      vm.params = vm.$route.query\n      vm.namespaceName = vm.params.namespaceName\n      vm.getConfigData()\n      vm.getEnvData()\n    },\n    methods: {\n      ...mapActions('synConfig', ['getConfigList', 'getNavTree', 'getSynData', 'setSynData']),\n      checked() {\n        const vm = this\n        let list = []\n        vm.navTree.forEach((res, i) => {\n          if (res.clusterName !== vm.params.clusterName) {\n            vm.$refs.navTree.toggleRowSelection(vm.navTree[i], true)\n            list.push(vm.navTree[i])\n          }\n        })\n        vm.navSelects = list\n      },\n      getConfigData() {\n        const vm = this\n        vm.getConfigList(vm)\n      },\n      getEnvData() {\n        const vm = this\n        vm.getNavTree(vm)\n      },\n      handleNext() {\n        const vm = this\n        if (vm.step === 1) {\n          if (vm.validateCheck()) {\n            vm.title = '(第二步检查Diff)'\n            vm.text = '上一步'\n            vm.step = 2\n            vm.synParam = {\n              syncItems: vm.configSelects,\n              syncToNamespaces: vm.navSelects\n            }\n            vm.getSynData(vm)\n          } else {\n            return false\n          }\n        } else {\n          vm.title = '(第一步选择同步信息)'\n          vm.text = '下一步'\n          vm.step = 1\n        }\n      },\n      validateCheck() {\n        let navSelects = false\n        let configSelects = false\n        if (this.navSelects.length > 0) {\n          navSelects = true\n        } else {\n          this.$message.warning('请选择集群')\n          return false\n        }\n        if (this.configSelects.length > 0) {\n          configSelects = true\n        } else {\n          this.$message.warning('请选择需要同步的配置')\n          return false\n        }\n        return navSelects && configSelects\n      },\n      handleNavChange(val) {\n        this.navSelects = val\n      },\n      handleConfigChange(val) {\n        this.configSelects = val\n      },\n      handleSyn() {\n        const vm = this\n        vm.dealSynData()\n        vm.setSynData(vm)\n      },\n      dealSynData() {\n        const vm = this\n        vm.synParamList = []\n        const _diffData = vm.commonFunc.arrCopy(vm.diffData)\n        const _navSelects = vm.commonFunc.arrCopy(vm.navSelects)\n        _diffData.map(res => {\n          let obj = {}\n          _navSelects.map(item => {\n            if (item.clusterName === res.namespace.clusterName && item.appId === res.namespace.appId && item.env === res.namespace.env) {\n              res.namespace = item\n            }\n          })\n          obj.syncItems = res.diffs\n          obj.syncToNamespaces = []\n          obj.syncToNamespaces.push(res.namespace)\n          if (obj.syncItems.length > 0 && obj.syncToNamespaces.length > 0) {\n            vm.synParamList.push(obj)\n          }\n        })\n      },\n      goBack() {\n        const vm = this\n        vm.$router.push({\n          name: 'configDetail',\n          query: {\n            appId: vm.params.appId\n          },\n          params: {\n            id: vm.params.appId\n          }\n        })\n        vm.step = 1\n        vm.title = '(第一步选择同步信息)'\n        vm.text = '下一步'\n      },\n      handleDelete(list, index) {\n        list.splice(index, 1)\n      },\n      updateItems(data) {\n        const params = data.namespace\n        const url = '/apollo-portal/apps/' + params.appId + /envs/ + params.env + /clusters/ + params.clusterName +\n          '/namespaces/' + params.namespaceName + '/items'\n        return this.$axios({\n          method: 'get',\n          url: url\n        }).then(res => {\n          let _diff = []\n          let updateItems = data.updateItems\n          if (updateItems.length > 0) {\n            let oldItemMap = {}\n            res.data.forEach(item => {\n              oldItemMap[item.key] = item.value\n            })\n            updateItems.forEach(item => {\n              item.oldValue = oldItemMap[item.key]\n              item.type = '更新'\n              data.diffs.push(item)\n            })\n          }\n          return _diff\n        }).catch(err => {\n          console.log(err)\n        })\n      }\n    }\n  }\n</script>\n\n<style type=\"text/scss\" lang=\"scss\" scoped>\n  @import '../../assets/common';\n\n  .syn-config {\n    .syn-header {\n      @include line-height(60px);\n      border-bottom: 1px solid #DCDCDC;\n      text-align: center;\n      .hd-title {\n        float: left;\n        font-size: $font20;\n        .sub-title {\n          font-size: $font14;\n        }\n      }\n      .hd-handle {\n        float: right;\n      }\n    }\n    .syn-center {\n      font-size: $font16;\n      .syn-tips {\n        background: #d9edf7;\n        border-radius: 3px;\n        margin-top: 20px;\n        padding-bottom: 5px;\n        .tips-title {\n          font-size: $font16;\n          font-weight: bolder;\n          padding: 15px 10px 10px 10px;\n        }\n        .tips-item {\n          padding: 10px 10px 10px 0;\n          font-size: $font14;\n        }\n      }\n      .syn-des {\n        padding: 20px;\n      }\n    }\n    .syn-info {\n      font-size: $font16;\n      color: $blue;\n      .info-space {\n        margin: 20px 0;\n        .info-hd {\n          padding: 20px;\n        }\n        .info-tb {\n          margin: 15px 0;\n        }\n      }\n      .info-space:first-child {\n        margin-top: 0;\n      }\n    }\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/config/syn-config.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"syn-config\"},[_c('div',{staticClass:\"syn-header clearfix\"},[_c('div',{staticClass:\"hd-title\"},[_vm._v(\"\\n      同步配置\\n      \"),_c('span',{staticClass:\"sub-title\"},[_vm._v(_vm._s(_vm.title))])]),_vm._v(\" \"),_c('div',{staticClass:\"hd-handle\"},[(_vm.step!=3)?_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.handleNext}},[_vm._v(_vm._s(_vm.text))]):_vm._e(),_vm._v(\" \"),(_vm.step===2&&_vm.hasDiff)?_c('el-button',{attrs:{\"type\":\"success\",\"size\":\"small\"},on:{\"click\":_vm.handleSyn}},[_vm._v(\"同步\")]):_vm._e(),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.goBack}},[_vm._v(\"返回项目首页\")])],1)]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.step===1),expression:\"step===1\"}],staticClass:\"syn-center\"},[_vm._m(0),_vm._v(\" \"),_c('div',{staticClass:\"syn-des\"},[_c('el-row',[_c('el-col',{attrs:{\"span\":3}},[_vm._v(\"同步到哪个集群\")]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":7}},[_c('el-table',{key:\"nav-table\",ref:\"navTree\",staticStyle:{\"width\":\"100%\"},attrs:{\"stripe\":\"\",\"data\":_vm.navTree,\"tooltip-effect\":\"dark\",\"max-height\":\"250\"},on:{\"selection-change\":_vm.handleNavChange}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"width\":\"55\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"env\",\"label\":\"环境\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"集群\"}})],1)],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":13,\"offset\":1}},[_c('el-table',{key:\"config-table\",ref:\"configList\",staticStyle:{\"width\":\"100%\"},attrs:{\"stripe\":\"\",\"data\":_vm.configList,\"tooltip-effect\":\"dark\",\"max-height\":\"250\"},on:{\"selection-change\":_vm.handleConfigChange}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"width\":\"55\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"Key\",\"prop\":\"key\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"value\",\"label\":\"Value\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"Create Time\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n                \"+_vm._s(_vm._f(\"formatDateTime\")(scope.row.dataChangeCreatedTime))+\"\\n              \")]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"Update Time\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n                \"+_vm._s(_vm._f(\"formatDateTime\")(scope.row.dataChangeLastModifiedTime))+\"\\n              \")]}}])})],1)],1)],1)],1)]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.step===2),expression:\"step===2\"}],staticClass:\"syn-info\"},_vm._l((_vm.diffData),function(list,index){return _c('div',{key:index,staticClass:\"info-space\"},[_c('div',{staticClass:\"info-hd\"},[_vm._v(\"\\n        环境：\"+_vm._s(list.namespace.env)+\" 集群：\"+_vm._s(list.namespace.clusterName)+\" NameSpace：\"+_vm._s(list.namespace.namespaceName)+\"\\n      \")]),_vm._v(\" \"),_c('div',{staticClass:\"info-tb\"},[(list.diffs.length>0)?_c('el-table',{key:\"list.namespace.clusterName\",staticStyle:{\"width\":\"100%\"},attrs:{\"data\":list.diffs,\"stripe\":\"\",\"size\":\"small\"}},[_c('el-table-column',{attrs:{\"prop\":\"type\",\"label\":\"Type\",\"width\":\"100\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"key\",\"label\":\"key\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"oldValue\",\"label\":\"同步前\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"value\",\"label\":\"同步后\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"comment\",\"label\":\"Comment\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"100\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{staticClass:\"btn-text-red\",attrs:{\"size\":\"small\",\"type\":\"text\"},on:{\"click\":function($event){_vm.handleDelete(list.diffs,scope.$index)}}},[_vm._v(\"删除\\n              \")])]}}])})],1):_c('div',{staticStyle:{\"color\":\"#ccc\"}},[_vm._v(\"没有更新的配置, 忽略同步\")])],1)])})),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.step===3),expression:\"step===3\"}],staticStyle:{\"text-align\":\"center\",\"padding\":\"20px\"}},[_c('img',{staticStyle:{\"height\":\"100px\",\"width\":\"100px\"},attrs:{\"src\":require(\"../../assets/images/sync-succ.png\")}}),_vm._v(\" \"),_c('div',{staticStyle:{\"font-size\":\"18px\",\"font-weight\":\"bolder\",\"margin-top\":\"10px\"}},[_vm._v(\"同步成功！\")])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"syn-tips\"},[_c('div',{staticClass:\"tips-title\"},[_vm._v(\"Tips：\")]),_vm._v(\" \"),_c('ul',{staticStyle:{\"padding-left\":\"40px\",\"list-style-type\":\"disc\"}},[_c('li',{staticClass:\"tips-item\"},[_vm._v(\"通过同步配置功能，可以使多个环境、集群间的配置保持一致\")]),_vm._v(\" \"),_c('li',{staticClass:\"tips-item\"},[_vm._v(\"需要注意的是，同步完之后需要发布后才会对应用生效\")])])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-145e42f8\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/config/syn-config.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-145e42f8\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./syn-config.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./syn-config.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./syn-config.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-145e42f8\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./syn-config.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-145e42f8\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/config/syn-config.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}