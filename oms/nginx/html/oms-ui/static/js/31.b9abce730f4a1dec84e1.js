webpackJsonp([31],{SV3n:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),r=a.n(s),n=a("exGp"),o=a.n(n),l=a("Dd8w"),i=a.n(l),c=a("NYxO"),u={data:function(){return{currentPage:1,pageSize:10,userForm:{hostIp:""},userVisible:!1,userTitle:"",addForm:{},addFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},oldParams:{}}},computed:i()({},Object(c.d)({userInfo:function(e){return e.host.userInfo}})),created:function(){this.getTableData()},methods:i()({},Object(c.b)("host",["getUserList","addHostUser","updateHostUser","delteHostUser"]),{getTableData:function(){var e={pageNo:this.currentPage,limit:this.pageSize,baseParam:this.userForm};this.getUserList(e)},searchUserInfo:function(){this.getTableData()},handleCurrentChange:function(e){this.currentPage=e,this.getTableData()},getIpValue:function(e){this.addForm.hostIp=e},openModal:function(e){e&&e.id?(this.userTitle="修改主机用户",this.addForm=i()({},e),this.oldParams={oldHostIp:e.hostIp,oldUsername:e.username}):(this.userTitle="添加主机用户",this.addForm={}),this.userVisible=!0},deleteItem:function(e){var t=this,a=this;a.$confirm("是否删除"+e.hostIp+"？","删除",{confirmButtonText:a.$t("common.ok"),cancelButtonText:a.$t("common.cancel"),type:"warning",center:!0}).then(o()(r.a.mark(function s(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a.delteHostUser({id:e.id});case 3:a.$message({type:"success",message:"删除成功！"}),a.getTableData(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a.$message({type:"success",message:t.t0.data&&t.t0.data.message||"删除失败"});case 10:case"end":return t.stop()}},s,t,[[0,7]])}))).catch(function(){})},cancel:function(){this.$refs.addForm.clearValidate(),this.userVisible=!1},onSubmit:function(){var e,t=this,a=this;a.$refs.addForm.validate((e=o()(r.a.mark(function e(s){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=32;break}if(a.addForm.hostIp&&!(a.addForm.hostIp&&a.addForm.hostIp.length<=3)){e.next=4;break}return a.$message({type:"warning",message:"请输入IP"}),e.abrupt("return");case 4:if(a.commonFunc.validateIp(a.addForm.hostIp)){e.next=7;break}return a.$message({type:"warning",message:"IP格式不正确"}),e.abrupt("return");case 7:if(!a.addForm.id){e.next=21;break}return e.prev=8,e.next=11,a.updateHostUser([a.oldParams,a.addForm]);case 11:a.$message({type:"success",message:"修改成功"}),a.cancel(),a.getTableData(),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(8),a.$message({type:"error",message:e.t0.data&&e.t0.data.message||"修改失败"});case 19:e.next=32;break;case 21:return e.prev=21,e.next=24,a.addHostUser(a.addForm);case 24:a.$message({type:"success",message:"添加成功"}),a.cancel(),a.getTableData(),e.next=32;break;case 29:e.prev=29,e.t1=e.catch(21),a.$message({type:"error",message:e.t1.data&&e.t1.data.message||"添加失败"});case 32:case"end":return e.stop()}},e,t,[[8,16],[21,29]])})),function(t){return e.apply(this,arguments)}))}})},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-main"},[a("div",{staticClass:"button-group"},[a("span",{staticClass:"route-name"},[e._v(e._s(e.$route.meta.title))]),e._v(" "),a("el-button",{attrs:{icon:"el-icon-plus",type:"warning",size:"small"},on:{click:function(t){e.openModal()}}},[e._v(e._s(e.$t("common.add")))])],1),e._v(" "),a("el-form",{ref:"userForm",attrs:{model:e.userForm,"label-width":"30px","label-position":"right",size:"small"}},[a("el-row",{staticClass:"label-first",attrs:{gutter:20}},[a("el-col",{attrs:{lg:6,xl:4}},[a("el-form-item",{attrs:{label:"IP："}},[a("el-input",{model:{value:e.userForm.hostIp,callback:function(t){e.$set(e.userForm,"hostIp","string"==typeof t?t.trim():t)},expression:"userForm.hostIp"}})],1)],1),e._v(" "),a("el-col",{attrs:{lg:6,xl:4}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.searchUserInfo}},[e._v(e._s(e.$t("common.search")))])],1)],1)],1),e._v(" "),a("el-table",{attrs:{data:e.userInfo.list,stripe:""}},[a("el-table-column",{attrs:{prop:"hostIp",label:"主机IP",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"密码",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("pwdFormat")(t.row.password))+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("common.operation"),align:"center",fixed:"right",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(a){e.openModal(t.row)}}},[e._v(e._s(e.$t("common.modify"))+"\n        ")]),e._v(" "),a("el-button",{staticClass:"btn-text-red",attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(a){e.deleteItem(t.row)}}},[e._v(e._s(e.$t("common.delete"))+"\n        ")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next, jumper",total:e.userInfo.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}}),e._v(" "),a("el-dialog",{attrs:{title:e.userTitle,visible:e.userVisible,width:"30%",center:""},on:{"update:visible":function(t){e.userVisible=t},close:e.cancel}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"主机IP",prop:"hostIp"}},[a("gl-ip-input",{on:{getIpValue:e.getIpValue},model:{value:e.addForm.hostIp,callback:function(t){e.$set(e.addForm,"hostIp",t)},expression:"addForm.hostIp"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{maxlength:"30"},model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username","string"==typeof t?t.trim():t)},expression:"addForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",maxlength:"30"},model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password","string"==typeof t?t.trim():t)},expression:"addForm.password"}})],1)],1),e._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v(e._s(e.$t("common.ok")))])],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(u,d,!1,function(e){a("tnNB")},"data-v-6260d3a9",null);t.default=m.exports},tnNB:function(e,t){}});
//# sourceMappingURL=31.b9abce730f4a1dec84e1.js.map