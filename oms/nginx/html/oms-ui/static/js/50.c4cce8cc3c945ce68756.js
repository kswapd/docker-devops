webpackJsonp([50],{Ezp5:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("woOf"),r=a.n(n),l=a("Xxa5"),o=a.n(l),s=a("exGp"),i=a.n(s),c=a("Dd8w"),u=a.n(c),p=a("NYxO"),d={data:function(){return{envId:"",dateForm:{},infoRes:null,currentPage:1,pageSize:10}},computed:u()({},Object(p.d)({envOptions:function(t){return t.processing.envOptions},batchTableData:function(t){return t.processing.batchTableData},batchTotal:function(t){return t.processing.batchTotal}})),methods:u()({},Object(p.b)("processing",["getBatchOption","getBatchEvnInfo","getBatchTableData","getBatchDate","updateBatchDate"]),{envChange:function(t){var e=this;return i()(o.a.mark(function a(){var n,r;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.getBatchEvnInfo({envId:t});case 2:return n=a.sent,e.infoRes=n.data,e.getBatchTableData({zk:e.infoRes.ZK,applicationGroup:e.infoRes.APP_GROUP}),a.next=7,e.getBatchDate({zk:e.infoRes.ZK,applicationGroup:e.infoRes.APP_GROUP});case 7:r=a.sent,console.log(r),e.dateForm={RUN_DATE:r.data.runDate,LAST_RUN_DATE:r.data.lastRunDate,NEXT_RUN_DATE:r.data.nextRunDate};case 10:case"end":return a.stop()}},a,e)}))()},updateDate:function(){var t=this;return i()(o.a.mark(function e(){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.envId){e.next=3;break}return t.$message.warning("请选择应用环境"),e.abrupt("return");case 3:return a=r()({zk:t.infoRes.ZK,applicationGroup:t.infoRes.APP_GROUP},t.dateForm),e.next=6,t.updateBatchDate(a);case 6:t.$message.success("更新日期成功");case 7:case"end":return e.stop()}},e,t)}))()},runBatch:function(t){var e={batchClass:t.BATCH_CLASS,zk:this.infoRes&&this.infoRes.ZK||"zookeeper://192.168.162.147:2191",applicationGroup:this.infoRes&&this.infoRes.APP_GROUP||"gaeaadmin"};this.$router.push({name:"batchRun",params:{id:t.BATCH_CLASS},query:e})},handleCurrentChange:function(t){this.currentPage=t}}),created:function(){this.getBatchOption()}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"batch-main"},[a("div",{staticClass:"button-group"},[a("span",{staticClass:"route-name"},[t._v(t._s(t.$route.meta.title))]),t._v(" "),a("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-plus"},on:{click:function(e){t.handleAdd()}}},[t._v(t._s(t.$t("common.add")))])],1),t._v(" "),a("el-form",{attrs:{modal:t.envForm,"label-position":"right",size:"small"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{lg:6,xl:4}},[a("el-form-item",{attrs:{label:"选择应用环境：",prop:"name"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.envChange},model:{value:t.envId,callback:function(e){t.envId=e},expression:"envId"}},t._l(t.envOptions,function(t){return a("el-option",{key:t.pkValue,attrs:{label:t.pkDesc,value:t.pkValue}})}))],1)],1)],1)],1),t._v(" "),a("el-form",{ref:"dateForm",attrs:{model:t.dateForm,"label-width":"140px","label-position":"right",size:"small"}},[a("el-row",{staticClass:"label-first",attrs:{gutter:20}},[a("el-col",{attrs:{lg:6,xl:4}},[a("el-form-item",{attrs:{label:"LAST_RUN_DATE："}},[a("el-input",{attrs:{disabled:""},model:{value:t.dateForm.LAST_RUN_DATE,callback:function(e){t.$set(t.dateForm,"LAST_RUN_DATE","string"==typeof e?e.trim():e)},expression:"dateForm.LAST_RUN_DATE"}})],1)],1),t._v(" "),a("el-col",{attrs:{lg:6,xl:4}},[a("el-form-item",{attrs:{label:"RUN_DATE："}},[a("el-input",{attrs:{disabled:""},model:{value:t.dateForm.RUN_DATE,callback:function(e){t.$set(t.dateForm,"RUN_DATE","string"==typeof e?e.trim():e)},expression:"dateForm.RUN_DATE"}})],1)],1),t._v(" "),a("el-col",{attrs:{lg:6,xl:4}},[a("el-form-item",{attrs:{label:"NEXT_RUN_DATE："}},[a("el-input",{attrs:{disabled:""},model:{value:t.dateForm.NEXT_RUN_DATE,callback:function(e){t.$set(t.dateForm,"NEXT_RUN_DATE","string"==typeof e?e.trim():e)},expression:"dateForm.NEXT_RUN_DATE"}})],1)],1),t._v(" "),a("el-col",{attrs:{lg:6,xl:4}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:t.updateDate}},[t._v("\n          更新日期\n        ")])],1)],1)],1),t._v(" "),a("el-table",{attrs:{data:t.batchTableData[t.currentPage-1],stripe:""}},[a("el-table-column",{attrs:{align:"center",prop:"BATCH_CLASS",label:"批处理"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"EOD_SOD",label:"EOD/SOD"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"BATCH_DESC",label:"批处理描述"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("common.operation"),align:"center",fixed:"right",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-caret-right"},on:{click:function(a){t.runBatch(e.row)}}},[t._v("运行\n        ")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":t.pageSize,layout:"total, prev, pager, next, jumper",total:t.batchTotal},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e}}})],1)},staticRenderFns:[]},f=a("VU/8")(d,m,!1,null,null,null);e.default=f.exports}});
//# sourceMappingURL=50.c4cce8cc3c945ce68756.js.map